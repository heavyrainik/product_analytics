SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201801 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201802 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201803 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201804 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201805 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201806 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201807 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201808 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201809 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201810 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201811 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201812 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201901 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201902 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201903 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201904 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
UNION
SELECT min(month), round(avg(salary)) as mean_salary FROM (SELECT min(dttm) as month, driver_id, count(order_id) as amount_of_orders, sum(order_cost) as salary FROM fediq_team.order_tables_201905 WHERE 64<=start_point_a_lat and start_point_a_lat<=65 GROUP BY driver_id) as A WHERE salary IS NOT NULL and driver_id IS NOT NULL and amount_of_orders > 9
